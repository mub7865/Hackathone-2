---
id: phr-1766874912
title: Kubernetes Minikube Deployment Spec Creation
stage: spec
date: 2025-12-28
surface: agent
model: claude-sonnet-4.5
feature: 008-k8s-minikube-deployment
branch: 008-k8s-minikube-deployment
user: mub7865
command: /sp.specify
labels: ["spec-driven", "kubernetes", "minikube", "helm"]
links:
  spec: D:\Hackathons\hackathon-2\specs\008-k8s-minikube-deployment\spec.md
  ticket: null
  adr: null
  pr: null
files:
  - D:\Hackathons\hackathon-2\specs\008-k8s-minikube-deployment\spec.md
  - D:\Hackathons\hackathon-2\specs\008-k8s-minikube-deployment\checklists\requirements.md
tests:
---
## Prompt

Deploy Phase III Todo Chatbot application on a local Kubernetes cluster using Minikube, with containerization via Docker and packaging via Helm charts. The goal is to containerize frontend (Next.js) and backend (FastAPI with OpenAI Agents SDK + MCP) applications, then deploy them as a cloud-native system on Minikube.

Requirements:

Core Requirements:
1. Containerization:
   - Create Dockerfiles for frontend (Next.js)
   - Create Dockerfiles for backend (FastAPI with OpenAI Agents SDK + MCP)
   - Optimize images with multi-stage builds
   - Use Docker AI Agent (Gordon) if available for AI-assisted Docker operations
2. Kubernetes Deployment:
   - Deploy frontend and backend as Kubernetes Deployments
   - Create Services for frontend (NodePort/LoadBalancer) and backend (ClusterIP)
   - Configure health checks (liveness and readiness probes)
   - Set up resource limits and requests
   - Deploy on Minikube locally
3. Helm Charts:
   - Create a Helm chart for the application
   - Structure: Chart.yaml, values.yaml, templates/ directory
   - Include templates for deployments, services, configmaps, secrets
   - Support configurable values (replicas, image tags, resource limits)
4. AIOps Tools:
   - Use kubectl-ai for AI-assisted Kubernetes operations (if available)
   - Use kagent for advanced cluster analysis and optimization (if available)
   - Note: If Gordon (Docker AI) is unavailable in region, use standard Docker CLI commands
5. Networking:
   - Frontend should be accessible via NodePort or LoadBalancer
   - Backend should be internal (ClusterIP)
   - Frontend connects to backend via service name
   - External database: Neon PostgreSQL (no database deployment needed)

Technology Stack:

| Component | Technology |
|-----------|-------------|
| Containerization | Docker / Docker Desktop |
| Docker AI | Docker AI Agent (Gordon) - if available |
| Container Orchestration | Kubernetes (Minikube) |
| Package Manager | Helm Charts |
| AI DevOps | kubectl-ai, kagent - if available |
| Frontend | Next.js (from Phase III) |
| Backend | FastAPI + OpenAI Agents SDK + MCP (from Phase III) |
| Database | Neon PostgreSQL (external connection) |

Architecture:

```
User Browser
      ↓
LoadBalancer/NodePort Service
      ↓
Frontend Pods (Next.js + OpenAI ChatKit)
      ↓ (API calls via NEXT_PUBLIC_API_URL)
ClusterIP Service
      ↓
Backend Pods (FastAPI + OpenAI Agents SDK + MCP Tools)
      ↓ (External connection)
Neon PostgreSQL
```

Acceptance Criteria:

Containerization:
- [ ] Frontend Dockerfile created with multi-stage build (development/production)
- [ ] Backend Dockerfile created with multi-stage build
- [ ] Images are optimized (size < 500MB)
- [ ] Environment variables are properly configured

Kubernetes Deployment:
- [ ] Frontend Deployment with configurable replicas
- [ ] Backend Deployment with configurable replicas
- [ ] Services created (ClusterIP for backend, NodePort/LoadBalancer for frontend)
- [ ] Health checks configured (liveness and readiness probes)
- [ ] Resource requests and limits set

Helm Charts:
- [ ] Chart.yaml with metadata and dependencies
- [ ] values.yaml with configurable parameters
- [ ] Template files for deployments and services
- [ ] Helper functions (_helpers.tpl) for reusable templates
- [ ] Secrets template for sensitive data

Deployment on Minikube:
- [ ] Minikube cluster started and verified
- [ ] Docker images loaded into Minikube
- [ ] Helm chart successfully deployed
- [ ] All pods are in Running state
- [ ] Application accessible via browser
- [ ] Frontend successfully connects to backend

AIOps (Optional/If Available):
- [ ] Gordon used for Docker operations
- [ ] kubectl-ai used for deployment commands
- [ ] kagent used for cluster health analysis

Constraints:

1. Scope:
   - Deploy only frontend and backend (Neon DB is external)
   - No need to deploy Kafka, Dapr, or other advanced components (that's Phase V)
   - Focus on Phase III chatbot application only
2. Environment:
   - Local deployment on Minikube (Docker driver recommended)
   - No cloud deployment required in this phase
   - Use existing Neon database (no new database setup)
3. Skills and Agents:
   - MUST use Phase 4 skills we created:
        - docker-containerization skill for Dockerfiles
      - kubernetes-deployment-patterns skill for K8s manifests
      - helm-chart-creation skill for Helm charts
      - minikube-local-development skill for Minikube operations
   - Use sub-agents: docker-builder, kubernetes-deployer, helm-chart-manager
4. Image Handling:
   - Use imagePullPolicy: Never for local Minikube images
   - Build images in Minikube's Docker context or load them
   - Tag images with version (e.g., v1.0.0)
5. Configuration:
   - Never hardcode secrets in YAML files
   - Use Kubernetes Secrets for all sensitive data
   - Use ConfigMaps for non-sensitive configuration

Out of Scope:

- Cloud deployment (DigitalOcean, GKE, AKS) - This is Phase V
- Database deployment on Kubernetes - Use external Neon
- Kafka deployment and event-driven architecture - This is Phase V
- Dapr integration - This is Phase V
- Advanced features (recurring tasks, reminders) - This is Phase V

Deliverables:

1. Dockerfiles:
   - calm-orbit-todo/frontend/Dockerfile
   - calm-orbit-todo/backend/Dockerfile
2. Kubernetes Manifests (Optional):
   - Raw YAML files (if not using Helm)
3. Helm Chart:
   - calm-orbit-todo/helm-chart/Chart.yaml
   - calm-orbit-todo/helm-chart/values.yaml
   - calm-orbit-todo/helm-chart/templates/ directory with templates
4. Documentation:
   - README.md with deployment instructions
   - .env.example files for configuration
   - Troubleshooting guide
5. Verification:
   - Application running on Minikube
   - Frontend accessible at minikube service URL
   - Backend API functional
   - Chatbot features working as in Phase III

Success Criteria:

1. User can start Minikube cluster
2. Docker images for frontend and backend build successfully
3. Helm chart deploys without errors
4. All pods are healthy and running
5. Application is accessible via browser
6. User can create, view, update, delete tasks through chatbot interface
7. All Phase III features work in Kubernetes deployment

## Response snapshot

### Outcome

✅ Specification created successfully with branch `008-k8s-minikube-deployment`

### Summary

- Created spec file at `D:\Hackathons\hackathon-2\specs\008-k8s-minikube-deployment\spec.md`
- Quality validation passed all checks
- Spec ready for planning phase (`/sp.plan`)

### Tests

N/A

### Files

- D:\Hackathons\hackathon-2\specs\008-k8s-minikube-deployment\spec.md
- D:\Hackathons\hackathon-2\specs\008-k8s-minikube-deployment\checklists\requirements.md

### Reflection notes

Spec includes comprehensive user stories for Minikube cluster startup, Docker image building, and Helm deployment. All requirements are testable and technology-agnostic.
